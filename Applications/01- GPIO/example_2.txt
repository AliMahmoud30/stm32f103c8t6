/*
 * main.c
 *
 *  Created on:
 *      Author: Ali Morsy
 */

/*=============================================================================
 *              Section: Includes
 =============================================================================*/
/*! Lib */
#include "STD_TYPES.h"
#include "BIT_MATH.h"

/*! Modules  */
#include "../02-MCAL/01-RCC/RCC_interface.h"
#include "../02-MCAL/02-GPIO/DIO_interface.h"
/*=====================================================================================
 *              Section: Macro Declarations
 =====================================================================================*/
#define PORTA_CRL	*((uint32_t*)0x40010800)
#define PORTA_ODR	*((uint32_t*)0x4001080C)

/*=====================================================================================
 *              Section: Macro Function Declarations
 =====================================================================================*/

/*=====================================================================================
 *              Section: variables Declarations
 =====================================================================================*/

pin_config_t pin_1 =
{
	.port 	  = GPIOA,
	.pin  	  = PIN1,
	.pin_mode = OUTPUT_SPEED_10MHZ_PP,
	.logic    = LOGIC_LOW
};

int main(void)
{
	/*! Initialize the system clock */
	RCC_voidInitSysClock();

	/* Enable Peripheral 2 on APB2 bus (GPIOA) */
	RCC_voidEnablePeripheralClock(RCC_APB2, IOPAEN);

	/* Configure A0 as Output Push Pull */
	PORTA_CRL =0x00000002;

	/* Set A0 Output High */
	PORTA_ODR =0x00000001;

	MGPIO_SetPinDirection(&pin_1);
	MGPIO_SetPinValue(&pin_1, LOGIC_HIGH);
	MGPIO_SetPinValue(&pin_1, LOGIC_LOW);
	MGPIO_TogglePin(&pin_1);

	while(1)
	{

		PORTA_ODR ^= 1;
		MGPIO_TogglePin(&pin_1);
		for(uint16_t i = 0; i< 500; i++)
		{
			for(uint16_t j = 0; j< 500; j++)
			{
				asm("NOP");
			}
		}
	}
	return 0;
}
